<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸ¯ çŒœæ•°å­— | Guess The Number</title>
  <style>
    :root{
      --bg:#0b1020;--card:#121a33;--muted:#8da2d3;--text:#eaf0ff;--accent:#6ea8fe;--accent2:#9dffb0;--warn:#ffb86b;--danger:#ff6b6b;
      --ring: 0 0 0 3px rgba(110,168,254,.35);
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial,"PingFang SC","Hiragino Sans GB","Microsoft YaHei",sans-serif;background:radial-gradient(1200px 800px at 20% -10%,#1c2550,transparent),radial-gradient(1000px 600px at 120% 10%,#1f2b63,transparent),var(--bg);color:var(--text)}
    .container{max-width:880px;margin:32px auto;padding:24px}
    .card{background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));backdrop-filter:saturate(120%) blur(6px);border:1px solid rgba(255,255,255,.06);border-radius:24px;box-shadow:0 20px 60px rgba(0,0,0,.35);padding:24px}
    h1{font-size:clamp(22px,4vw,34px);margin:0 0 8px;letter-spacing:.5px}
    .sub{color:var(--muted);margin-bottom:18px}
    .grid{display:grid;grid-template-columns:1.2fr .8fr;gap:20px}
    @media (max-width:800px){.grid{grid-template-columns:1fr}}

    .controls{display:flex;flex-wrap:wrap;gap:12px;align-items:center;margin:10px 0 16px}
    .seg{display:inline-flex;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:6px}
    .seg button{appearance:none;border:0;background:transparent;color:var(--muted);padding:8px 12px;border-radius:10px;font-weight:600;cursor:pointer}
    .seg button[aria-pressed="true"]{background:rgba(110,168,254,.15);color:#e9f2ff;box-shadow:inset 0 0 0 1px rgba(110,168,254,.5)}

    .stat{display:flex;gap:10px;flex-wrap:wrap;color:var(--muted);font-size:14px}
    .chip{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border:1px dashed rgba(255,255,255,.12);border-radius:999px}

    .panel{background:rgba(0,0,0,.16);border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:16px}

    label{font-size:13px;color:var(--muted)}
    input[type=number]{width:100%;padding:12px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.15);background:rgba(0,0,0,.2);color:var(--text);outline:none}
    input[type=number]:focus{box-shadow:var(--ring);border-color:rgba(110,168,254,.6)}

    .row{display:flex;gap:10px;margin-top:10px}
    .btn{appearance:none;border:0;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer;color:#0b1020}
    .btn-primary{background:linear-gradient(180deg,#7fb6ff,#4d8dff)}
    .btn-ghost{background:transparent;color:var(--text);border:1px solid rgba(255,255,255,.25)}
    .btn-warning{background:linear-gradient(180deg,#ffd89e,#ffb86b)}
    .btn-danger{background:linear-gradient(180deg,#ff9a9a,#ff6b6b)}
    .btn:disabled{opacity:.6;cursor:not-allowed}

    .feedback{margin-top:10px;min-height:28px;font-size:15px}
    .feedback strong{font-weight:800}
    .feedback .ok{color:var(--accent2)}
    .feedback .hi{color:var(--warn)}
    .feedback .lo{color:var(--accent)}
    .feedback .bad{color:var(--danger)}

    .history{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
    .tag{padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);font-size:13px}

    .scoreboard{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .score{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:12px}
    .score h4{margin:0 0 8px;font-size:14px;color:var(--muted)}

    footer{margin-top:16px;color:var(--muted);font-size:12px}
  </style>
</head>
<body>
  <div class="container">
    <div class="card" role="main">
      <h1>ğŸ¯ çŒœæ•°å­—ï¼ˆGuess The Numberï¼‰</h1>
      <p class="sub">é€‰æ‹©éš¾åº¦ï¼Œå¼€å§‹æ¸¸æˆï¼›è¾“å…¥æ•°å­—åæŒ‰ <kbd>Enter</kbd> æˆ–ç‚¹å‡»â€œæäº¤çŒœæµ‹â€ã€‚ç³»ç»Ÿä¼šæç¤º <em>é«˜/ä½</em>ï¼Œç”¨å°½é‡å°‘çš„æ¬¡æ•°çŒœä¸­ç›®æ ‡ï¼</p>

      <div class="grid">
        <!-- å·¦ä¾§ï¼šæ¸¸æˆé¢æ¿ -->
        <section class="panel" aria-labelledby="game-panel">
          <h2 id="game-panel" style="margin-top:0;font-size:16px;color:var(--muted);">æ¸¸æˆ</h2>

          <!-- éš¾åº¦é€‰æ‹© -->
          <div class="controls" aria-label="é€‰æ‹©éš¾åº¦">
            <div class="seg" role="group" aria-label="éš¾åº¦åˆ‡æ¢">
              <button id="d-easy"   data-diff="easy"   aria-pressed="true">ğŸŒ± ç®€å•</button>
              <button id="d-normal" data-diff="normal" aria-pressed="false">ğŸš€ æ ‡å‡†</button>
              <button id="d-hard"   data-diff="hard"   aria-pressed="false">ğŸ”¥ å›°éš¾</button>
            </div>
            <button id="start" class="btn btn-primary">å¼€å§‹æ–°æ¸¸æˆ</button>
            <button id="reset" class="btn btn-ghost" disabled>é‡ç½®</button>
          </div>

          <!-- çŠ¶æ€æ¡ -->
          <div class="stat">
            <span class="chip">èŒƒå›´ï¼š<strong id="range-label">1 - 50</strong></span>
            <span class="chip">å‰©ä½™æ¬¡æ•°ï¼š<strong id="left">â€”</strong></span>
            <span class="chip">å·²ç”¨æ¬¡æ•°ï¼š<strong id="used">â€”</strong></span>
            <span class="chip">ç”¨æ—¶ï¼š<strong id="timer">00:00</strong></span>
          </div>

          <!-- è¾“å…¥åŒºåŸŸ -->
          <div style="margin-top:12px">
            <label for="guess">è¾“å…¥ä½ çš„çŒœæµ‹ï¼š</label>
            <input id="guess" type="number" inputmode="numeric" min="1" max="50" placeholder="ä¾‹å¦‚ï¼š23" disabled aria-describedby="hint">
            <div id="hint" class="feedback" aria-live="polite"></div>
            <div class="row">
              <button id="submit" class="btn btn-warning" disabled>æäº¤çŒœæµ‹</button>
              <button id="giveup" class="btn btn-danger" disabled>æ”¾å¼ƒæœ¬å±€</button>
            </div>
          </div>

          <!-- å†å²è®°å½• -->
          <div class="history" id="history" aria-label="å†å²çŒœæµ‹"></div>
        </section>

        <!-- å³ä¾§ï¼šæ’è¡Œæ¦œ/è§„åˆ™ -->
        <aside class="panel" aria-labelledby="side-panel">
          <h2 id="side-panel" style="margin-top:0;font-size:16px;color:var(--muted);">è®°å½• & è§„åˆ™</h2>
          <div class="scoreboard" id="scoreboard">
            <!-- åŠ¨æ€æ¸²æŸ“æœ€ä½³æˆç»© -->
          </div>
          <ul style="margin:14px 0 0 18px;line-height:1.7;color:var(--muted)">
            <li>æ­£ç¡®èŒƒå›´å†…çš„æœ‰æ•ˆè¾“å…¥æ‰æ¶ˆè€—ä¸€æ¬¡æœºä¼šã€‚</li>
            <li>æç¤ºï¼š<span class="lo">åä½</span> / <span class="hi">åé«˜</span>ï¼›çŒœä¸­æ˜¾ç¤º <span class="ok">âœ… æ­£ç¡®</span>ã€‚</li>
            <li>æœ€ä½³è®°å½•æ¯”è¾ƒï¼šå…ˆæ¯”ç”¨æ¬¡æ•°ï¼Œè‹¥ç›¸åŒå†æ¯”ç”¨æ—¶ã€‚</li>
            <li>æŒ‰ <kbd>Enter</kbd> å¿«é€Ÿæäº¤çŒœæµ‹ã€‚</li>
          </ul>
        </aside>
      </div>

      <footer>Made with â¤ï¸ çº¯å‰ç«¯å®ç°ï¼ˆæ”¯æŒç¦»çº¿è¿è¡Œï¼Œè®°å½•å­˜å‚¨åœ¨æœ¬åœ°æµè§ˆå™¨ï¼‰ã€‚</footer>
    </div>
  </div>

  <script>
    // --- éš¾åº¦é…ç½® ---
    const DIFFS = {
      easy:   { max: 50,  tries: 10 },
      normal: { max: 100, tries: 8  },
      hard:   { max: 500, tries: 10 }
    };

    // --- å…ƒç´ å¼•ç”¨ ---
    const el = {
      diffBtns: Array.from(document.querySelectorAll('.seg button')),
      start: document.getElementById('start'),
      reset: document.getElementById('reset'),
      range: document.getElementById('range-label'),
      left: document.getElementById('left'),
      used: document.getElementById('used'),
      timer: document.getElementById('timer'),
      input: document.getElementById('guess'),
      hint: document.getElementById('hint'),
      submit: document.getElementById('submit'),
      giveup: document.getElementById('giveup'),
      history: document.getElementById('history'),
      board: document.getElementById('scoreboard')
    };

    // --- çŠ¶æ€ ---
    let state = {
      diff: 'easy',
      target: null,
      max: DIFFS.easy.max,
      left: 0,
      used: 0,
      startedAt: 0,
      timerHandle: null,
      guesses: []
    };

    // --- æœ¬åœ°è®°å½•é”® ---
    const LS_KEY = 'gtn.best.v1';

    function loadBest(){
      try{ return JSON.parse(localStorage.getItem(LS_KEY)) || {}; }catch{ return {}; }
    }
    function saveBest(best){ localStorage.setItem(LS_KEY, JSON.stringify(best)); }

    function fmtTime(sec){
      sec = Math.max(0, Math.floor(sec));
      const m = String(Math.floor(sec/60)).padStart(2,'0');
      const s = String(sec%60).padStart(2,'0');
      return `${m}:${s}`;
    }

    function startTimer(){
      stopTimer();
      state.startedAt = Date.now();
      el.timer.textContent = '00:00';
      state.timerHandle = setInterval(()=>{
        const elapsed = (Date.now()-state.startedAt)/1000;
        el.timer.textContent = fmtTime(elapsed);
      }, 250);
    }
    function stopTimer(){ if(state.timerHandle){ clearInterval(state.timerHandle); state.timerHandle=null; } }

    function setDifficulty(diff){
      state.diff = diff;
      state.max = DIFFS[diff].max;
      el.diffBtns.forEach(b=> b.setAttribute('aria-pressed', String(b.dataset.diff===diff)) );
      el.range.textContent = `1 - ${state.max}`;
      el.input.setAttribute('max', String(state.max));
    }

    function setUIPlaying(isPlaying){
      el.input.disabled = !isPlaying;
      el.submit.disabled = !isPlaying;
      el.giveup.disabled = !isPlaying;
      el.reset.disabled = false;
      el.start.disabled = isPlaying;
      if(isPlaying){ el.input.focus(); }
    }

    function newGame(){
      const { tries } = DIFFS[state.diff];
      state.target = 1 + Math.floor(Math.random()*state.max);
      state.left = tries;
      state.used = 0;
      state.guesses = [];
      el.left.textContent = tries;
      el.used.textContent = 0;
      el.history.innerHTML = '';
      el.hint.innerHTML = 'æ¸¸æˆå·²å¼€å§‹ï¼Œç¥ä½ å¥½è¿ï¼';
      el.input.value = '';
      setUIPlaying(true);
      startTimer();
      // console.debug('Target:', state.target);
    }

    function endGame(win){
      setUIPlaying(false);
      stopTimer();
      if(win){
        const elapsed = Math.round((Date.now()-state.startedAt)/1000);
        el.hint.innerHTML = `<strong class="ok">âœ… æ­£ç¡®ï¼</strong> æ•°å­—æ˜¯ <strong>${state.target}</strong>ã€‚ä½ ç”¨äº† <strong>${state.used}</strong> æ¬¡ï¼Œç”¨æ—¶ <strong>${fmtTime(elapsed)}</strong>ã€‚`;
        updateBest(state.diff, state.used, elapsed);
      } else {
        el.hint.innerHTML = `<strong class="bad">âŒ æœºä¼šç”¨å°½</strong>ï¼Œç›®æ ‡æ˜¯ <strong>${state.target}</strong>ã€‚å†è¯•ä¸€æ¬¡ï¼`;
      }
      renderBoard();
    }

    function pushHistory(n){
      const tag = document.createElement('span');
      tag.className = 'tag';
      tag.textContent = String(n);
      el.history.prepend(tag);
    }

    function makeGuess(){
      const v = Number(el.input.value.trim());
      if(!Number.isFinite(v)) { feedback('è¯·è¾“å…¥æœ‰æ•ˆæ•°å­—', 'bad'); return; }
      if(v < 1 || v > state.max){ feedback(`è¯·è¾“å…¥èŒƒå›´å†…çš„æ•°å­—ï¼ˆ1 - ${state.max}ï¼‰`, 'bad'); return; }

      // æœ‰æ•ˆçŒœæµ‹æ‰æ¶ˆè€—æœºä¼š
      state.left -= 1;
      state.used += 1;
      el.left.textContent = state.left;
      el.used.textContent = state.used;
      state.guesses.push(v);
      pushHistory(v);

      if(v === state.target){ feedback('âœ… æ­£ç¡®ï¼', 'ok'); endGame(true); return; }
      if(state.left <= 0){ feedback('æœºä¼šç”¨å°½ã€‚', 'bad'); endGame(false); return; }

      if(v < state.target){
        const delta = state.target - v;
        feedback(delta<=3 ? 'æœ‰ç‚¹ä½ï¼Œä½†å¾ˆæ¥è¿‘ï¼' : 'åä½ï¼Œå†é«˜ä¸€ç‚¹ã€‚', 'lo');
      } else {
        const delta = v - state.target;
        feedback(delta<=3 ? 'æœ‰ç‚¹é«˜ï¼Œä½†å¾ˆæ¥è¿‘ï¼' : 'åé«˜ï¼Œå†ä½ä¸€ç‚¹ã€‚', 'hi');
      }
      el.input.select();
    }

    function feedback(text, cls){ el.hint.innerHTML = `<span class="${cls}">${text}</span>`; }

    function giveUp(){
      if(state.target==null) return;
      el.hint.innerHTML = `æœ¬å±€å·²ç»“æŸï¼Œæ­£ç¡®ç­”æ¡ˆæ˜¯ <strong>${state.target}</strong>ã€‚`;
      endGame(false);
    }

    function updateBest(diff, used, seconds){
      const best = loadBest();
      const prev = best[diff];
      if(!prev || used < prev.used || (used===prev.used && seconds < prev.seconds)){
        best[diff] = { used, seconds, at: new Date().toISOString() };
        saveBest(best);
      }
    }

    function renderBoard(){
      const best = loadBest();
      const rows = [
        ['ğŸŒ± ç®€å•', 'easy'],
        ['ğŸš€ æ ‡å‡†', 'normal'],
        ['ğŸ”¥ å›°éš¾', 'hard']
      ].map(([label,key])=>{
        const b = best[key];
        if(!b){
          return `<div class="score"><h4>${label}</h4><div>æš‚æ— è®°å½•</div></div>`;
        }
        return `<div class="score"><h4>${label}</h4><div>æœ€ä¼˜æ¬¡æ•°ï¼š<strong>${b.used}</strong><br>æœ€ä½³ç”¨æ—¶ï¼š<strong>${fmtTime(b.seconds)}</strong></div></div>`;
      }).join('');
      el.board.innerHTML = rows;
    }

    // --- äº‹ä»¶ç»‘å®š ---
    el.diffBtns.forEach(btn=>{
      btn.addEventListener('click', ()=>{
        setDifficulty(btn.dataset.diff);
        // æœªå¼€å§‹çŠ¶æ€ä¸‹æ›´æ–°è¾“å…¥æœ€å¤§å€¼æ˜¾ç¤º
        el.range.textContent = `1 - ${state.max}`;
        el.input.max = state.max;
      })
    });

    el.start.addEventListener('click', ()=> newGame());
    el.reset.addEventListener('click', ()=>{ stopTimer(); setUIPlaying(false); el.hint.innerHTML = 'å·²é‡ç½®ï¼Œç‚¹å‡»â€œå¼€å§‹æ–°æ¸¸æˆâ€ã€‚'; el.left.textContent='â€”'; el.used.textContent='â€”'; el.timer.textContent='00:00'; el.history.innerHTML=''; });
    el.submit.addEventListener('click', makeGuess);
    el.giveup.addEventListener('click', giveUp);
    el.input.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ makeGuess(); }});

    // åˆå§‹æ¸²æŸ“
    setDifficulty('easy');
    renderBoard();
  </script>
</body>
</html>
